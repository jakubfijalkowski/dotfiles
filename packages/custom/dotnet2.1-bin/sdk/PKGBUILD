pkgname='dotnet2.1-sdk-bin'
_runtimever=2.1.15
_aspnetver=2.1.15
_sdkver=2.1.803
pkgver=${_runtimever/-/}
pkgver=${pkgver//-/+}
pkgrel=1
arch=('x86_64')
url='https://www.microsoft.com/net/core'
license=('MIT')
options=(staticlibs)
source=('https://download.visualstudio.microsoft.com/download/pr/701502b0-f9a2-464f-9832-4e6ca3126a2a/62655f151db917025e9be8cc4b7c1ed9/dotnet-sdk-2.1.803-linux-x64.tar.gz')
sha512sums=('57d48d6ca1bd92ac348dc05220d984811c0cf005774d7afdfbbf125a842acb0a26572146ed25a7eb26f4e0404fe840b70d1e7ec1fb7c9a5c6cfe81fefc41b363')

package_dotnet2.1-runtime-bin()
{
    pkgdesc='The .NET Core 2.1 runtime'
    depends=("dotnet-host>=${pkgver}" 'icu' 'krb5' 'libunwind' 'openssl' 'zlib' 'libcurl.so')
    optdepends=('lttng-ust: CoreCLR tracing')
    provides=("dotnet-runtime=${pkgver}")

    install -d "${pkgdir}"/usr/share/{dotnet/shared,licenses}

    cp -dr --no-preserve=ownership \
        "${srcdir}"/shared/Microsoft.NETCore.* \
        "${pkgdir}/usr/share/dotnet/shared/"

    ln -s dotnet-host "${pkgdir}/usr/share/licenses/${pkgname}"
}

package_aspnet2.1-runtime-bin()
{
    pkgdesc='The ASP.NET Core 2.1 runtime'
    _runtimever=${_runtimever/-/}
    _runtimever=${_runtimever//-/+}
    depends=("dotnet-runtime=${_runtimever}")

    install -d "${pkgdir}"/usr/share/{dotnet/shared,licenses}

    cp -dr --no-preserve=ownership \
        "${srcdir}"/shared/Microsoft.AspNetCore.* \
        "${pkgdir}/usr/share/dotnet/shared/"

    ln -s dotnet-host "${pkgdir}/usr/share/licenses/${pkgname}"
}

package_dotnet2.1-sdk-bin()
{
    pkgdesc='The .NET Core 2.1 SDK'
    _runtimever=${_runtimever/-/}
    _runtimever=${_runtimever//-/+}
    depends=("dotnet-runtime=${_runtimever}")

    install -d "${pkgdir}"/usr/share/{dotnet,licenses}

    cp -dr --no-preserve=ownership \
        "${srcdir}"/sdk \
        "${pkgdir}/usr/share/dotnet/"

    ln -s dotnet-host "${pkgdir}/usr/share/licenses/${pkgname}"
}
